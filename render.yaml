# render.yaml - Defines the application blueprint for Render

services:
  # ==================================
  # == PRODUCTION NODE.JS SERVICE ==
  # ==================================
  - name: renvo-node-final
    type: web
    runtime: docker
    repo: https://github.com/TheBigCompany1/Renvo
    branch: main
    autoDeploy: true
    healthCheckPath: /api/ping
    # Note: Production envVars are managed in the Render Dashboard.

  # ==================================
  # == PRODUCTION PYTHON SERVICE ==
  # ==================================
  - name: renvo-python
    type: web
    runtime: python
    repo: https://github.com/TheBigCompany1/Renvo
    branch: main
    autoDeploy: true
    rootDir: backend/agent_service
    buildCommand: "pip install -r requirements.txt"
    startCommand: "gunicorn --worker-class gevent --workers 4 app:app"
    healthCheckPath: /healthz
    # Note: Production envVars are managed in the Render Dashboard.

# ==================================================
# == PREVIEW ENVIRONMENT (STAGING) CONFIGURATION ==
# ==================================================
# THE FIX: The 'previews:' block is now an object, not a list.
# The hyphen that was causing the error has been removed.
previews:
  path: /
  services:
    # For PRs, create a preview of the Node.js service...
    - name: renvo-node-final
      # ...and apply the variables from your existing staging group.
      envVarGroup: renvo-staging

    # For PRs, create a preview of the Python service...
    - name: renvo-python
      # ...and apply the same staging variables.
      envVarGroup: renvo-staging