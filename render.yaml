# render.yaml - Simplified for clarity and correctness

services:
  # The Node.js Frontend/Proxy Service for Production
  - name: renvo-node-final
    type: web
    runtime: docker
    repo: https://github.com/TheBigCompany1/Renvo
    branch: main # Deploys from the main branch
    healthCheckPath: /api/ping
    # Production environment variables should be set in the Render dashboard, not here.

  # The Python Backend Service for Production
  - name: renvo-python
    type: web
    runtime: python
    repo: https://github.com/TheBigCompany1/Renvo
    branch: main # Deploys from the main branch
    rootDir: backend/agent_service
    buildCommand: pip install -r requirements.txt
    startCommand: gunicorn --worker-class gevent --workers 4 app:app
    healthCheckPath: /healthz
    # Production environment variables should be set in the Render dashboard, not here.

# This section tells Render how to build your Pull Requests
previews:
  - services:
      # For PRs, create a preview of the Node.js service...
      - name: renvo-node-final
        # ...and apply the variables from your existing staging group.
        envVarGroup: renvo-staging
      # Also for PRs, create a preview of the Python service...
      - name: renvo-python
        # ...and apply the same staging variables.
        envVarGroup: renvo-staging